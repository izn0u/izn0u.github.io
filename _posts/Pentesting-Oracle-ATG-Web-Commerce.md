# Pentesting Oracle ATG Web Commerce

This blog post aims to compile vulnerabilities identified during an investigation into a target utilizing Oracle Web Commerce (Oracle ATG).
 I will keep updating as i have some CVE pending.

## What is Oracle ATG?

Oracle ATG (Art Technology Group), also known as Oracle Web Commerce, is a robust and widely-used e-commerce platform that enables businesses to create personalized, seamless online shopping experiences for their customers. It offers a comprehensive suite of tools for managing product catalogs, pricing, promotions, and customer data.


### How to Identify ATG Usage?

To identify if a website uses ATG, look for:
- Cookies containing `atg`, `dyn`
- Send a `GET` request to `/ControlCenter/about.jsp`. The expected response includes an image or text indicative of ATG usage.

![ATG About Page](https://raw.githubusercontent.com/izn0u/izn0u.github.io/main/images/atg-about.png)

#### Vulnerabilities:

- **Unauthorized Access to ATG Nucleus Panel:** Accessing the Nucleus panel at `https://www.redacted.com/nucleus/` allows an attacker to discover admin password hashes at `/nucleus/atg/dynamo/security/adminSqlRepository/?action=seeitems&itemdesc=account#seeItems`. This can lead to logging into the admin dashboard at `/dyn/admin` (ATG Dynamo Server Admin dashboard).

![Nucleus ATG Panel](https://raw.githubusercontent.com/izn0u/izn0u.github.io/main/images/nucleus-atg.png)

- **Unauthorized Access to Oracle ATG Web Commerce Service Center:** Unauthorized access to the Service Center at `https://www.redacted.com/agent/main.jsp` exposes sensitive functionalities and data.

- **(Dead Flash) XSS Vulnerability**: A cross-site scripting (XSS) vulnerability exists at `https://www.redacted.com/dojo-1-6-2/dojox/av/resources/audio.swf?id=\"))-alert(1);}catch(e){}//`. For further information, refer to the security advisory at [dojotoolkit.org](https://dojotoolkit.org/blog/dojo-security-advisory-2014-12-08).


#### wordlist:
 - https://github.com/izn0u/Custom-Wordlist-Directory-Bruteforce/blob/main/oracle-atg-web-commerce-final.txt